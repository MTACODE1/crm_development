"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[583],{6583:(E,p,i)=>{i.r(p),i.d(p,{TaskListModule:()=>I});var u=i(4859),f=i(9549),h=i(7392),k=i(4466),v=i(6298),x=i(2510),c=i(7340),m=i(4006),l=(()=>{return(n=l||(l={})).SETUP="setup",n.BOOK="book_keeping",n.VAT="vat",n.ANNUAL="annual_accounts",n.SELF="self_assessment",l;var n})(),_=i(5439),T=i(7579),d=i(2722),t=i(4650),y=i(1683),M=i(3079),O=i(7495),C=i(6895),L=i(4385),b=i(3238);function Z(n,a){if(1&n&&(t.TgZ(0,"mat-option",8),t._uU(1),t.qZA()),2&n){const e=a.$implicit;t.Q6J("value",e.id),t.xp6(1),t.AsE(" ",null==e?null:e.name," ",null==e?null:e.surname," ")}}function A(n,a){if(1&n&&(t.TgZ(0,"span",27),t._uU(1),t.qZA()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.date)}}function P(n,a){if(1&n&&(t.TgZ(0,"a",24),t._UZ(1,"img",28),t.qZA()),2&n){const e=t.oxw(3);t.MGl("href","https://go.xero.com/organisationlogin/default.aspx?shortcode=",null==e.selectedClient?null:e.selectedClient.xero,"",t.LSH)}}function w(n,a){if(1&n&&(t.TgZ(0,"a",24),t._UZ(1,"img",29),t.qZA()),2&n){const e=t.oxw(3);t.MGl("href","https://app.dext.com/clients/",null==e.selectedClient?null:e.selectedClient.dext,"/gamma/costs/inbox",t.LSH)}}function S(n,a){if(1&n&&(t.TgZ(0,"a",24),t._UZ(1,"img",30),t.qZA()),2&n){const e=t.oxw(3);t.MGl("href","https://find-and-update.company-information.service.gov.uk/company/",null==e.selectedClient?null:e.selectedClient.crn,"",t.LSH)}}function U(n,a){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",16),t.NdJ("click",function(){const r=t.CHM(e).$implicit,g=t.oxw(2);return t.KtG(g.markCompleted(r))}),t.TgZ(2,"div",17)(3,"div",18)(4,"button",19),t._UZ(5,"mat-icon",20),t.qZA(),t.TgZ(6,"div",21)(7,"p"),t._uU(8),t.qZA(),t.YNc(9,A,2,1,"span",22),t.qZA()()(),t.TgZ(10,"div",23),t.NdJ("click",function(s){return s.stopImmediatePropagation()}),t.TgZ(11,"a",24),t._UZ(12,"img",25),t.qZA(),t.YNc(13,P,2,1,"a",26),t.YNc(14,w,2,1,"a",26),t.YNc(15,S,2,1,"a",26),t.qZA()(),t.BQk()}if(2&n){const e=a.$implicit,o=t.oxw().$implicit,s=t.oxw();t.xp6(1),t.MT6("flex flex-col border-b overflow-hidden priority_",o.color,"_",e.priority," cursor-pointer list-item"),t.Q6J("@myTrigger",s.state),t.xp6(4),t.Tol("2"!==e.t_status?"text-hint":"text-primary"),t.Q6J("svgIcon","heroicons_outline:check-circle"),t.xp6(3),t.Oqu(e.text),t.xp6(1),t.Q6J("ngIf",e.date),t.xp6(2),t.MGl("href","https://www.morethanaccountants.co.uk/salesflow/admin/v_lead.html?id=",null==s.selectedClient?null:s.selectedClient.id,"",t.LSH),t.xp6(2),t.Q6J("ngIf",null==s.selectedClient?null:s.selectedClient.xero),t.xp6(1),t.Q6J("ngIf",null==s.selectedClient?null:s.selectedClient.dext),t.xp6(1),t.Q6J("ngIf",null==s.selectedClient?null:s.selectedClient.crn)}}function J(n,a){if(1&n&&(t.ynx(0),t.TgZ(1,"p"),t._uU(2,"No task Found !!!"),t.qZA(),t.BQk()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.Gre("text-center my-4 text-",e.color,"-800 text-lg font-bold opacity-50")}}function N(n,a){if(1&n&&(t.TgZ(0,"div",9)(1,"div",10)(2,"h1",11),t._uU(3),t.qZA(),t.TgZ(4,"div",12),t._UZ(5,"mat-icon",13),t.qZA()(),t.YNc(6,U,16,14,"ng-container",14),t.YNc(7,J,3,3,"ng-container",15),t.qZA()),2&n){const e=a.$implicit,o=t.oxw();t.xp6(3),t.Oqu(e.name),t.xp6(2),t.MT6("icon-size-18 opacity-25 text-",e.color,"-800 dark:text-",e.color,"-800"),t.xp6(1),t.Q6J("ngForOf",e.text),t.xp6(1),t.Q6J("ngIf",!e.text&&!o.isLoading)}}const F=[{path:"",component:(()=>{class n{constructor(e,o,s){this._fuseConfirmationService=e,this.taskService=o,this.userService=s,this.username=new m.NI,this.users=[],this.taskListArr=[{color:"gray",name:"Setup & Compliance",dataType:l.SETUP},{color:"yellow",name:"Bookkeeping",dataType:l.BOOK},{color:"orange",name:"VAT",dataType:l.VAT},{color:"pink",name:"Annual Accounts",dataType:l.ANNUAL},{color:"green",name:"Self Assessment",dataType:l.SELF}],this.isLoading=!0,this.destroyer$=new T.x}ngOnInit(){this.getTaskList({}),this.getUserList()}ngOnDestroy(){this.destroyer$.next(),this.destroyer$.complete()}getTaskList(e){let o={};e&&(o={...e}),this.taskService.getTaskList(o).pipe((0,d.R)(this.destroyer$)).subscribe(s=>{const r=s;Object.keys(r).forEach(g=>{this.taskListArr.map((Q,Y)=>{Q.dataType===g&&(this.taskListArr[Y].text=r[g].length?r[g].sort((B,R)=>B.t_status-R.t_status):null,this.isLoading=!1)})})})}onClientChange(e){const o={uid:e.value,month:_(new Date).format("MMM-yyyy")};this.username.setValue(e.value),this.getTaskList(o),this.getUserList()}getUserList(){this.userService.getUserTable({client_status:1}).pipe((0,d.R)(this.destroyer$)).subscribe(e=>{this.users=e.rows,this.selectedClient=this.users.find(o=>o.id===this.username.value)})}markCompleted(e){this._fuseConfirmationService.open({title:"Are you sure?",message:"2"!==e.t_status?`Mark <b>${e.text}</b> as completed ?`:`Mark <b>${e.text}</b> as uncompleted?`,dismissible:!0,actions:{cancel:{label:"No"},confirm:{label:"Yes",color:"warn"}}}).afterClosed().pipe((0,d.R)(this.destroyer$)).subscribe(s=>{"confirmed"===s&&this.moveCompleted(e,"2"!==e.t_status)})}moveCompleted(e,o){this.taskService.updateTaskStatus({id:e.task_id,t_status:o?2:1}).pipe((0,d.R)(this.destroyer$)).subscribe(r=>{this.getTaskList({uid:this.username.value,month:_(new Date).format("MMM-yyyy")})})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(y.R),t.Y36(M.a),t.Y36(O.K))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-task-list"]],decls:9,vars:3,consts:[[1,"w-full"],[1,"flex","flex-col","px-6","pt-6"],["for","status",1,"text-xl"],["appearance","none","id","status",1,"w-36"],["placeholder","Select Client","disableOptionCentering","",1,"text-lg","text-gray-500",3,"formControl","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[1,"flex","w-full","p-6","sm:p-6","flex-wrap","h-fit","task-lists"],["class","flex-1 mx-2 bg-white rounded-md drop-shadow-lg",4,"ngFor","ngForOf"],[3,"value"],[1,"flex-1","mx-2","bg-white","rounded-md","drop-shadow-lg"],[1,"relative","overflow-hidden"],[1,"mb-4","text-xl","font-bold","py-3","px-4","text-center"],[1,"absolute","bottom-0","right-0","w-18","h-18","-m-6"],["svgIcon","heroicons_outline:check-circle"],[4,"ngFor","ngForOf"],[4,"ngIf"],[3,"click"],[1,"flex","flex-auto","flex-col","px-4","py-3","mb-4"],[1,"flex"],["mat-icon-button",""],[3,"svgIcon"],[1,"ml-2"],["class","text-sm",4,"ngIf"],[1,"items-center","justify-end","flex-wrap","icon-list","mb-2","px-3",3,"click"],["target","_blank",3,"href"],["src","assets/images/logo/logo.png","alt","logo",1,"h-auto","w-12"],["target","_blank",3,"href",4,"ngIf"],[1,"text-sm"],["src","assets/images/logo/bespoke.png","alt","bespoke",1,"h-auto","w-8"],["src","assets/images/logo/dext.png","alt","dext",1,"h-auto","w-9"],["src","assets/images/logo/ltd.png","alt","ltd",1,"h-auto","w-8"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"label",2),t._uU(3,"Select User"),t.qZA(),t.TgZ(4,"mat-form-field",3)(5,"mat-select",4),t.NdJ("selectionChange",function(r){return o.onClientChange(r)}),t.YNc(6,Z,2,3,"mat-option",5),t.qZA()()(),t.TgZ(7,"div",6),t.YNc(8,N,8,7,"div",7),t.qZA()()),2&e&&(t.xp6(5),t.Q6J("formControl",o.username),t.xp6(1),t.Q6J("ngForOf",o.users),t.xp6(2),t.Q6J("ngForOf",o.taskListArr))},dependencies:[C.sg,C.O5,m.JJ,f.KE,L.gD,b.ey,m.oH,h.Hw,u.lW],styles:[".task-lists[_ngcontent-%COMP%]   .priority_gray_low[_ngcontent-%COMP%]{background:rgba(128,128,128,.1490196078)}.task-lists[_ngcontent-%COMP%]   .priority_gray_high[_ngcontent-%COMP%]{background:rgba(128,128,128,.3607843137)}.task-lists[_ngcontent-%COMP%]   .priority_yellow_high[_ngcontent-%COMP%]{background:#E0D2C2}.task-lists[_ngcontent-%COMP%]   .priority_yellow_low[_ngcontent-%COMP%]{background:rgba(224,210,194,.3215686275)}.task-lists[_ngcontent-%COMP%]   .priority_orange_high[_ngcontent-%COMP%]{background:rgba(229,204,195,.7490196078)}.task-lists[_ngcontent-%COMP%]   .priority_orange_low[_ngcontent-%COMP%]{background:rgba(229,204,195,.2901960784)}.task-lists[_ngcontent-%COMP%]   .priority_pink_high[_ngcontent-%COMP%]{background:rgba(230,197,210,.7607843137)}.task-lists[_ngcontent-%COMP%]   .priority_pink_low[_ngcontent-%COMP%]{background:rgba(230,197,210,.3411764706)}.task-lists[_ngcontent-%COMP%]   .priority_green_high[_ngcontent-%COMP%]{background:rgba(196,216,204,.6117647059)}.task-lists[_ngcontent-%COMP%]   .priority_green_low[_ngcontent-%COMP%]{background:rgba(196,216,204,.2784313725)}.list-item[_ngcontent-%COMP%]:hover   .icon-list[_ngcontent-%COMP%]{display:flex!important}.list-item[_ngcontent-%COMP%]:hover   .icon-list[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(2){margin:0 4px}.list-item[_ngcontent-%COMP%]:hover   .icon-list[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(3){margin-right:4px}.icon-list[_ngcontent-%COMP%]{display:none}.text-pink-800[_ngcontent-%COMP%]{color:#9d174d}.text-orange-800[_ngcontent-%COMP%]{color:#9a3412}"],data:{animation:[(0,c.X$)("myTrigger",[(0,c.SB)("fadeInFlash",(0,c.oB)({opacity:"1"})),(0,c.eR)("void => *",[(0,c.oB)({opacity:"0",transform:"translateY(20px)"}),(0,c.jt)("500ms")])])]}}),n})()}];let $=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[x.Bz.forChild(F),x.Bz]}),n})(),I=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[k.m,h.Ps,v.vi,u.ot,f.lN,$]}),n})()}}]);