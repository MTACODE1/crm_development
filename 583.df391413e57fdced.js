"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[583],{6583:(E,p,s)=>{s.r(p),s.d(p,{TaskListModule:()=>I});var u=s(4859),f=s(9549),_=s(7392),v=s(4977),k=s(6298),h=s(2510),c=s(7340),d=s(4006),l=(()=>{return(n=l||(l={})).SETUP="setup",n.BOOK="book_keeping",n.VAT="vat",n.ANNUAL="annual_accounts",n.SELF="self_assessment",l;var n})(),C=s(5439),T=s(7579),g=s(2722),t=s(4650),y=s(1683),M=s(3079),O=s(7495),x=s(6895),b=s(4385),L=s(3238);function Z(n,a){if(1&n&&(t.TgZ(0,"mat-option",8),t._uU(1),t.qZA()),2&n){const e=a.$implicit;t.Q6J("value",e.id),t.xp6(1),t.AsE(" ",null==e?null:e.name," ",null==e?null:e.surname," ")}}function A(n,a){if(1&n&&(t.TgZ(0,"span",27),t._uU(1),t.qZA()),2&n){const e=t.oxw(2).$implicit;t.xp6(1),t.Oqu(e.date)}}function P(n,a){if(1&n&&(t.TgZ(0,"a",24),t._UZ(1,"img",28),t.qZA()),2&n){const e=t.oxw(4);t.MGl("href","https://go.xero.com/organisationlogin/default.aspx?shortcode=",null==e.selectedClient?null:e.selectedClient.xero,"",t.LSH)}}function w(n,a){if(1&n&&(t.TgZ(0,"a",24),t._UZ(1,"img",29),t.qZA()),2&n){const e=t.oxw(4);t.MGl("href","https://app.dext.com/clients/",null==e.selectedClient?null:e.selectedClient.dext,"/gamma/costs/inbox",t.LSH)}}function S(n,a){if(1&n&&(t.TgZ(0,"a",24),t._UZ(1,"img",30),t.qZA()),2&n){const e=t.oxw(4);t.MGl("href","https://find-and-update.company-information.service.gov.uk/company/",null==e.selectedClient?null:e.selectedClient.crn,"",t.LSH)}}function U(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"div",16),t.NdJ("click",function(){t.CHM(e);const o=t.oxw().$implicit,r=t.oxw(2);return t.KtG(r.markCompleted(o))}),t.TgZ(1,"div",17)(2,"div",18)(3,"button",19),t._UZ(4,"mat-icon",20),t.qZA(),t.TgZ(5,"div",21)(6,"p"),t._uU(7),t.qZA(),t.YNc(8,A,2,1,"span",22),t.qZA()()(),t.TgZ(9,"div",23),t.NdJ("click",function(o){return o.stopImmediatePropagation()}),t.TgZ(10,"a",24),t._UZ(11,"img",25),t.qZA(),t.YNc(12,P,2,1,"a",26),t.YNc(13,w,2,1,"a",26),t.YNc(14,S,2,1,"a",26),t.qZA()()}if(2&n){const e=t.oxw().$implicit,i=t.oxw().$implicit,o=t.oxw();t.MT6("flex flex-col border-b overflow-hidden priority_",i.color,"_",e.priority," cursor-pointer list-item"),t.Q6J("@myTrigger",o.state),t.xp6(4),t.Tol("2"!==e.t_status?"text-hint":"text-primary"),t.Q6J("svgIcon","heroicons_outline:check-circle"),t.xp6(3),t.Oqu(e.description),t.xp6(1),t.Q6J("ngIf",e.date),t.xp6(2),t.MGl("href","https://www.morethanaccountants.co.uk/salesflow/admin/v_lead.html?id=",null==o.selectedClient?null:o.selectedClient.id,"",t.LSH),t.xp6(2),t.Q6J("ngIf",null==o.selectedClient?null:o.selectedClient.xero),t.xp6(1),t.Q6J("ngIf",null==o.selectedClient?null:o.selectedClient.dext),t.xp6(1),t.Q6J("ngIf",null==o.selectedClient?null:o.selectedClient.crn)}}function J(n,a){if(1&n&&(t.ynx(0),t.YNc(1,U,15,14,"div",15),t.BQk()),2&n){const e=a.$implicit;t.xp6(1),t.Q6J("ngIf",e.description)}}function N(n,a){if(1&n&&(t.TgZ(0,"div",9)(1,"div",10)(2,"h1",11),t._uU(3),t.qZA(),t.TgZ(4,"div",12),t._UZ(5,"mat-icon",13),t.qZA()(),t.YNc(6,J,2,1,"ng-container",14),t.qZA()),2&n){const e=a.$implicit;t.xp6(3),t.Oqu(e.name),t.xp6(2),t.MT6("icon-size-18 opacity-25 text-",e.color,"-800 dark:text-",e.color,"-800"),t.xp6(1),t.Q6J("ngForOf",e.text)}}const $=[{path:"",component:(()=>{class n{constructor(e,i,o){this._fuseConfirmationService=e,this.taskService=i,this.userService=o,this.username=new d.NI,this.users=[],this.taskListArr=[{color:"gray",name:"Setup & Compliance",dataType:l.SETUP},{color:"yellow",name:"Bookkeeping",dataType:l.BOOK},{color:"orange",name:"VAT",dataType:l.VAT},{color:"pink",name:"Annual Accounts",dataType:l.ANNUAL},{color:"green",name:"Self Assessment",dataType:l.SELF}],this.destroyer$=new T.x}ngOnInit(){this.getTaskList({}),this.getUserList()}ngOnDestroy(){this.destroyer$.next(),this.destroyer$.complete()}getTaskList(e){let i={};e&&(i={...e}),this.taskService.getTaskList(i).pipe((0,g.R)(this.destroyer$)).subscribe(o=>{const r=o;Object.keys(r).forEach(m=>{this.taskListArr.map((Q,Y)=>{Q.dataType===m&&(this.taskListArr[Y].text=r[m].length?r[m].sort((B,R)=>B.t_status-R.t_status):null)})})})}onClientChange(e){const i={uid:e.value,month:C(new Date).format("MMM-yyyy")};this.username.setValue(e.value),this.getTaskList(i)}getUserList(){this.userService.getUserTable({client_status:1}).pipe((0,g.R)(this.destroyer$)).subscribe(e=>{this.users=e.rows,this.selectedClient=this.users.find(i=>i.id===this.username.value)})}markCompleted(e){this._fuseConfirmationService.open({title:"Are you sure?",message:"2"!==e.t_status?`Mark <b>${e.text}</b> as completed ?`:`Mark <b>${e.text}</b> as uncompleted?`,dismissible:!0,actions:{cancel:{label:"No"},confirm:{label:"Yes",color:"warn"}}}).afterClosed().pipe((0,g.R)(this.destroyer$)).subscribe(o=>{"confirmed"===o&&this.moveCompleted(e,"2"!==e.t_status)})}moveCompleted(e,i){this.taskService.updateTaskStatus({id:e.task_id,t_status:i?2:1}).pipe((0,g.R)(this.destroyer$)).subscribe(r=>{this.getTaskList({uid:this.username.value,month:C(new Date).format("MMM-yyyy")})})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(y.R),t.Y36(M.a),t.Y36(O.K))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-task-list"]],decls:9,vars:3,consts:[[1,"w-full"],[1,"flex","flex-col","px-6","pt-6"],["for","status",1,"text-xl"],["appearance","none","id","status",1,"w-36"],["placeholder","Select Client","disableOptionCentering","",1,"text-lg","text-gray-500",3,"formControl","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[1,"flex","w-full","p-6","sm:p-6","flex-wrap","h-fit","task-lists"],["class","flex-1 mx-2 bg-white rounded-md drop-shadow-lg  mb-3",4,"ngFor","ngForOf"],[3,"value"],[1,"flex-1","mx-2","bg-white","rounded-md","drop-shadow-lg","mb-3"],[1,"relative","overflow-hidden"],[1,"mb-4","text-xl","font-bold","py-3","px-4","text-center"],[1,"absolute","bottom-0","right-0","w-18","h-18","-m-6"],["svgIcon","heroicons_outline:check-circle"],[4,"ngFor","ngForOf"],[3,"class","click",4,"ngIf"],[3,"click"],[1,"flex","flex-auto","flex-col","px-4","py-3","mb-4"],[1,"flex"],["mat-icon-button",""],[3,"svgIcon"],[1,"ml-2"],["class","text-sm",4,"ngIf"],[1,"items-center","justify-end","flex-wrap","icon-list","mb-2","px-3",3,"click"],["target","_blank",3,"href"],["src","assets/images/logo/logo.png","alt","logo",1,"h-auto","w-12"],["target","_blank",3,"href",4,"ngIf"],[1,"text-sm"],["src","assets/images/logo/bespoke.png","alt","bespoke",1,"h-auto","w-8"],["src","assets/images/logo/dext.png","alt","dext",1,"h-auto","w-9"],["src","assets/images/logo/ltd.png","alt","ltd",1,"h-auto","w-8"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"label",2),t._uU(3,"Select User"),t.qZA(),t.TgZ(4,"mat-form-field",3)(5,"mat-select",4),t.NdJ("selectionChange",function(r){return i.onClientChange(r)}),t.YNc(6,Z,2,3,"mat-option",5),t.qZA()()(),t.TgZ(7,"div",6),t.YNc(8,N,7,6,"div",7),t.qZA()()),2&e&&(t.xp6(5),t.Q6J("formControl",i.username),t.xp6(1),t.Q6J("ngForOf",i.users),t.xp6(2),t.Q6J("ngForOf",i.taskListArr))},dependencies:[x.sg,x.O5,d.JJ,f.KE,b.gD,L.ey,d.oH,_.Hw,u.lW],styles:[".task-lists[_ngcontent-%COMP%]   .priority_gray_low[_ngcontent-%COMP%]{background:rgba(128,128,128,.1490196078)}.task-lists[_ngcontent-%COMP%]   .priority_gray_high[_ngcontent-%COMP%]{background:rgba(128,128,128,.3607843137)}.task-lists[_ngcontent-%COMP%]   .priority_yellow_high[_ngcontent-%COMP%]{background:#E0D2C2}.task-lists[_ngcontent-%COMP%]   .priority_yellow_low[_ngcontent-%COMP%]{background:rgba(224,210,194,.3215686275)}.task-lists[_ngcontent-%COMP%]   .priority_orange_high[_ngcontent-%COMP%]{background:rgba(229,204,195,.7490196078)}.task-lists[_ngcontent-%COMP%]   .priority_orange_low[_ngcontent-%COMP%]{background:rgba(229,204,195,.2901960784)}.task-lists[_ngcontent-%COMP%]   .priority_pink_high[_ngcontent-%COMP%]{background:rgba(230,197,210,.7607843137)}.task-lists[_ngcontent-%COMP%]   .priority_pink_low[_ngcontent-%COMP%]{background:rgba(230,197,210,.3411764706)}.task-lists[_ngcontent-%COMP%]   .priority_green_high[_ngcontent-%COMP%]{background:rgba(196,216,204,.6117647059)}.task-lists[_ngcontent-%COMP%]   .priority_green_low[_ngcontent-%COMP%]{background:rgba(196,216,204,.2784313725)}.list-item[_ngcontent-%COMP%]:hover   .icon-list[_ngcontent-%COMP%]{display:flex!important}.list-item[_ngcontent-%COMP%]:hover   .icon-list[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(2){margin:0 4px}.list-item[_ngcontent-%COMP%]:hover   .icon-list[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(3){margin-right:4px}.icon-list[_ngcontent-%COMP%]{display:none}.text-pink-800[_ngcontent-%COMP%]{color:#9d174d}.text-orange-800[_ngcontent-%COMP%]{color:#9a3412}"],data:{animation:[(0,c.X$)("myTrigger",[(0,c.SB)("fadeInFlash",(0,c.oB)({opacity:"1"})),(0,c.eR)("void => *",[(0,c.oB)({opacity:"0",transform:"translateY(20px)"}),(0,c.jt)("500ms")])])]}}),n})()}];let F=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[h.Bz.forChild($),h.Bz]}),n})(),I=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[v.m,_.Ps,k.vi,u.ot,f.lN,F]}),n})()}}]);